package com.xs0.asyncdb;

import com.xs0.asyncdb.common.Configuration;
import com.xs0.asyncdb.common.RowData;
import com.xs0.asyncdb.mysql.MySQLConnection;

import java.nio.charset.StandardCharsets;
import java.util.Arrays;
import java.util.Collections;
import java.util.concurrent.CountDownLatch;

public class QuickTest {
    static final String testQuery = "SELECT VSO.id_skupine, VSO.id_osebe, VSO.id_organizacije, VSO.tip, VSO.id_treninga, VSO.id_postavke FROM vadbene_skupine_osebe AS VSO WHERE VSO.id_osebe IN (X'30316131316439662D633761342D313165362D383632662D303031383531373238366437', X'30336565666539342D373963312D313165362D383666392D303031383531373238366437', X'30323435633161392D303465632D313165372D393063382D303031383531373238366437', X'30346635333531362D656466632D343437612D393138382D353834663738343131373861', X'30343633636565342D376665372D343066352D626465322D393037306433613633383236', X'30323464643037382D383130632D346530322D393032392D346334383633343962373663', X'30356463373162322D323563372D343930392D396638312D333232353464663965626333', X'30323735656263302D323764322D346362332D383863322D313236613735663261393562', X'30333464323030632D383964662D343230392D623530332D366130333465663264323535', X'30343563343735632D616638362D343662332D396161372D373363363165303962343138', X'30313934653162332D343964372D343734632D393033382D323238323161353934326661', X'30333066663439302D623864312D313165372D626339352D303031383531613035333930', X'30303533316263332D333437642D343636662D613430352D636362613334643561643365', X'30356333326532342D366565632D313165362D383666392D303031383531373238366437', X'30343530333439662D393364382D313165372D626339352D303031383531613035333930', X'30343465383162652D383930342D313165372D626339352D303031383531613035333930', X'30323637323232362D303131312D313165372D393063382D303031383531373238366437', X'30323337663335312D383738382D343863642D393432312D656539633339646363643137', X'30306364366334392D383635392D313165372D626339352D303031383531613035333930', X'30303239396163662D653239662D346334302D623138332D396136353633656230626133', X'30323834643839652D666461612D313165362D393063382D303031383531373238366437', X'30303364663565362D373339342D313165362D383666392D303031383531373238366437', X'30346238623036642D396436342D313165372D626339352D303031383531613035333930', X'30336637616232632D396466302D346631612D623632372D316565663232666562333337', X'30326132616561392D663361392D313165362D393063382D303031383531373238366437', X'30346531346439322D383063362D343362632D623834302D666666643133366466656562', X'30333336666133662D386565382D343365322D383839342D323762623139336135366163', X'30333133343435312D626333332D346330362D616465332D393530333839303430306562', X'30306131343631302D333930372D343762392D623639312D373238636564353430616462', X'30346236323338342D653563622D313165352D396565352D303031383531623364626464', X'30356437373935342D646266312D313165352D396565352D303031383531623364626464', X'30303161323562622D613563332D313165362D383632662D303031383531373238366437', X'30323436336432352D663466302D346636312D626232372D323537333539613734663338', X'30336337323831632D313837342D343766382D396636352D346138333164653131663730', X'30306164633263312D396361622D346637392D626338352D633235336264386565313262', X'30313663323237302D373064332D343238372D393330322D383833313838636462303038', X'30313834353637302D336335362D346138342D623761392D373730633437356230343661', X'30323239653037352D633439352D313165372D616430302D303031383531346335313461', X'30316432373633632D353565342D346337312D386232392D316364656335643138336533', X'30303763343131662D396634342D346238372D623733632D643033333162373536623161', X'30356664663236332D616533662D343431362D393635322D336139346461656334623863', X'30326632353066632D623836392D313165352D396565352D303031383531623364626464', X'30323834316566612D376239662D343737362D386263392D303738353762333164323162', X'30313733323039332D616163302D313165372D626339352D303031383531613035333930', X'30356162663532392D356133302D346530302D393262622D663935326462643234393133', X'30343237343364392D373931312D343565302D386161342D373636383635663066306562', X'30353831373663332D633032372D343038642D613939642D663238303838346563396233', X'30353064623939622D643532632D313165372D616430302D303031383531346335313461', X'30343064376437362D386134392D313165362D383632662D303031383531373238366437', X'30303664333137662D376161392D313165362D383666392D303031383531373238366437', X'30313831373064382D393064612D313165372D626339352D303031383531613035333930', X'30323431313564372D633362322D343238302D613730332D303339353965356166663335', X'30323333356330352D653163362D343832392D383130342D316431616263376134303066', X'30306264353363332D646432362D343139382D393066662D396464633039346334346131', X'30306466393463622D326638632D343830632D613061612D316635653636633439613636', X'30306561323164372D643336642D343161652D626638312D646631386363376565393337', X'30313365333164372D353731382D346361332D383561302D616439326130663834316366', X'30323463623533662D643332652D346539312D623664322D376162626237393937373565', X'30353863303865302D373963392D313165362D383666392D303031383531373238366437', X'30343463613739342D393235632D313165372D626339352D303031383531613035333930', X'30353361636362322D393436652D313165362D383632662D303031383531373238366437', X'30316563353433312D643066352D343364342D386432612D643463306265656435366333', X'30326332623166652D363131302D343733332D623161612D303030613038383734633233', X'30336234383738382D386536622D313165372D626339352D303031383531613035333930', X'30353536363035622D666333352D313165372D616430302D303031383531346335313461', X'30343766313561332D353835362D343931622D626561392D353162306233663838623339', X'30356464643533662D633739322D313165362D383632662D303031383531373238366437', X'30356639363439632D636632622D346362312D613762362D393438303030323864303337', X'30343562663162332D643466362D346162352D396463332D363063653366326335633835', X'30316466393330362D303131302D313165372D393063382D303031383531373238366437', X'30313662616563392D633561332D343134392D383530652D663261333632616563636639', X'30316331613063382D396435362D343636332D626564382D393962373134646632346463', X'30326664306237372D633939352D343539352D386634332D373461646161663335313137', X'30316363626135302D313537352D343639352D616231662D376439373366633139653966', X'30323961663235382D323434342D346263352D383265342D316163396330343761303734', X'30343433346462362D666139312D343966632D613565632D316239643832326134616631', X'30356331663130342D393234352D313165372D626339352D303031383531613035333930', X'30303539646262632D306633622D343836642D623937662D343331633237363237393534', X'30333337616134632D613636612D313165362D383632662D303031383531373238366437', X'30336339396239352D613434312D343335632D616530632D323133396430636432613936', X'30333664653232312D666366632D313165362D393063382D303031383531373238366437', X'30353635316132662D396564632D313165372D626339352D303031383531613035333930', X'30313965363961362D663533652D313165362D393063382D303031383531373238366437', X'30333766663439332D646633342D313165362D393063382D303031383531373238366437', X'30343335383339632D656263302D343037642D626534392D363331643366373234376230', X'30313831323062352D373537322D346635652D383737642D626664386664373761613966', X'30303035343733322D353261642D343830632D383133622D626537333430356639636336', X'30343735333633612D383938382D313165362D383632662D303031383531373238366437', X'30323361666363652D363030342D343461382D396637652D666237323231343430653134', X'30326130663737652D313063612D346561332D393232302D626163653862643036353338', X'30343835666562302D313331662D313165382D616430302D303031383531346335313461', X'30333534323934642D616666342D313165372D626339352D303031383531613035333930', X'30303866343165622D663263352D313165362D393063382D303031383531373238366437', X'30346138393239322D363438332D346138342D396533312D336137356336636236383731', X'30346330393533352D323235622D343565362D623331352D396633373637306463363231', X'30306538333264302D626361342D313165362D383632662D303031383531373238366437', X'30353365376164632D616539322D343432382D383435612D333333343532666136656338', X'30333037666666392D623034302D313165372D626339352D303031383531613035333930', X'30326635343162372D653536652D346561622D626535322D656133306234303839363163', X'30326434316632392D393331382D313165372D626339352D303031383531613035333930', X'30306265303366622D633761322D313165362D383632662D303031383531373238366437', X'30303639613934622D313331632D313165382D616430302D303031383531346335313461', X'30313138616533622D333931312D313165382D616430302D303031383531346335313461', X'30303231343430622D643139312D343133332D383130372D383763343438366637613866', X'30323236383332332D303164302D343337622D393165322D343837363666373962636635', X'30303132653033642D653837642D313165362D393063382D303031383531373238366437', X'30353366656635662D393230352D343237652D383433632D376537663732616330616138', X'30323538326563622D333032372D313165372D393063382D303031383531373238366437', X'30343934326430642D313864392D313165382D616430302D303031383531346335313461', X'30336131313562302D376464642D346233382D626562342D646537343833383139363763', X'30356333626630662D633966362D343563372D623538312D653739333064316434323935', X'30353238643564362D646265662D313165352D396565352D303031383531623364626464', X'30356431663831622D323266392D313165382D616430302D303031383531346335313461', X'30306633623538342D613436372D313165372D626339352D303031383531613035333930', X'30356237636530342D623562382D313165372D626339352D303031383531613035333930', X'30313164613063642D616138342D343134372D613631612D356436306565316138623033', X'30313762383363382D623935652D313165372D616430302D303031383531346335313461', X'30353835666138322D303632322D343935312D393335302D643638393431313537663966', X'30313034323431652D353765662D343331652D623037382D316636656239643434383839', X'30343961383762362D643030322D346262372D383461312D626333333533323666393534', X'30343934326139642D383831612D343234342D613836622D353836626132303563333333', X'30346531616164382D663533662D313165362D393063382D303031383531373238366437', X'30313763366430302D376161302D313165362D383666392D303031383531373238366437', X'30303734333135302D646335352D313165372D616430302D303031383531346335313461', X'30353431616463662D323565362D313165372D393063382D303031383531373238366437', X'30346266613461322D633137372D343130312D393336392D623235323463393432613935', X'30303164373434372D373063322D346334332D613536392D633632333263343930623331', X'30316438323934352D386362642D313165362D383632662D303031383531373238366437', X'30303231643262342D306466372D343336362D626635322D383861326439353132353735', X'30356137343461322D646266382D343566332D623236372D363431363032376631303538', X'30353861616530642D376333372D313165362D383666392D303031383531373238366437', X'30343435633462322D306537332D343930652D383630372D656238326131356139636536', X'30326134323438362D393365372D343535632D626666322D613164326531353537636135', X'30333935303263372D613763382D343865332D383765352D623036323337393263313461', X'30353538323332382D396566622D346164332D396164662D326236343939353037353264', X'30336131383561662D376463372D346461362D623130342D383465666638346339306432', X'30323463386234662D376561352D343039662D393530622D323630303631623435326264', X'30333262326135612D336630392D313165372D393063382D303031383531373238366437', X'30303933656434642D303164622D343163322D383264312D373564323964353830663135', X'30343835663065652D616133632D343462632D613261392D393134353732313064313832', X'30353664653030332D396435382D313165372D626339352D303031383531613035333930', X'30336339336439392D393462392D313165372D626339352D303031383531613035333930', X'30313531373730312D303335342D313165372D393063382D303031383531373238366437', X'30353166383364302D373932312D343438322D386162302D396438366530656236333931', X'30343764653165632D376639392D346263642D613133382D363237613862643733656538', X'30336336303633372D653563652D346362382D383465322D333637653739343762633930', X'30313566336332392D383839322D346233352D386537622D656462386230653935336265', X'30323232646164362D306136622D313165372D393063382D303031383531373238366437')";

    public static void main(String[] args) throws InterruptedException {
        Configuration conf = new Configuration(
            "eteam",
            "127.0.0.1",
            3306,
            "",
            "eteam",
            null,
            StandardCharsets.UTF_8,
            null,
            null,
            null,
            null,
            null
        );

        CountDownLatch latch = new CountDownLatch(1);

        MySQLConnection connection = new MySQLConnection(conf, null, null);

        connection.connect().whenComplete((conn, error) -> {
            conn.sendQuery("SELECT 2 + 3").whenComplete((queryResult, queryError) -> {
                System.out.println(queryResult.resultSet().getColumnNames());
                System.out.println(queryResult.resultSet().get(0));
                System.out.println(queryError);

                conn.sendQuery(testQuery).whenComplete((query2Result, query2Error) -> {
                    System.out.println(query2Error);
                    System.out.println(query2Result.resultSet().getColumnNames());
                    System.out.println(query2Result.resultSet().get(0));

                });

                conn.prepareStatement("SHOW TABLES").whenComplete((psResult, psError) -> {
                    System.out.println(psError);
                    System.out.println(psResult);

                    psResult.execute(Collections.emptyList()).whenComplete((execResult, execError) -> {
                        conn.disconnect().whenComplete((disconnectResult, disconnectError) -> {
                            latch.countDown();
                        });

                        System.out.println(execError);
                        System.out.println(execResult.resultSet().size() + " rows");
                        System.out.println(execResult.resultSet().getColumnNames().size() + " columns");
                        for (RowData row : execResult.resultSet()) {
                            System.out.println(row);
                        }
                    });
                });
            });
        });

        latch.await();
    }
}
